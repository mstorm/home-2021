services:
  zitadel:
    image: ghcr.io/zitadel/zitadel:latest
    container_name: zitadel
    restart: unless-stopped
    env_file:
      - ${OPS_ROOT:-.}/etc/global.env
      - ${OPS_ROOT:-.}/etc/srv/foundation.zitadel.env
    networks:
      - net_internal
    labels:
      - traefik.enable=true
      - traefik.http.routers.zitadel.rule=Host(`${ZITADEL_HOST}`)
      - traefik.http.routers.zitadel.entrypoints=websecure
      - traefik.http.routers.zitadel.tls.certresolver=le-dns
      - traefik.http.services.zitadel.loadbalancer.server.port=${ZITADEL_INTERNAL_PORT}
    # NOTE: ZITADEL command/config is version-specific. Fill via env/command as per official docs.

networks:
  net_internal:
    external: true
    name: net_internal
