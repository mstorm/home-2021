# ZITADEL Configuration

# Traefik routing
ZITADEL_HOST=id.home.internal
ZITADEL_INTERNAL_PORT=8080

# External domain (used for login URLs, etc.)
ZITADEL_EXTERNALDOMAIN=id.home.internal
ZITADEL_EXTERNALSECURE=true
ZITADEL_TLS_ENABLED=true

# Master key / secrets (REQUIRED - 32 characters)
# Generate a 32-byte master key for encrypting sensitive data:
#   openssl rand -base64 24 | tr -d "=+/" | head -c 32
# WARNING: Once set, changing this key will make encrypted data inaccessible!
ZITADEL_MASTERKEY=__REPLACE_ME__

# Database connection settings (PostgreSQL)
# The database is created by the init job if it does not exist.
ZITADEL_DATABASE_POSTGRES_HOST=postgres
ZITADEL_DATABASE_POSTGRES_PORT=5432
ZITADEL_DATABASE_POSTGRES_DATABASE=zitadel

# Admin user must already exist in the database
ZITADEL_DATABASE_POSTGRES_ADMIN_USERNAME=postgres
ZITADEL_DATABASE_POSTGRES_ADMIN_PASSWORD=__REPLACE_ME__
ZITADEL_DATABASE_POSTGRES_ADMIN_SSL_MODE=disable

# The zitadel user is created by the init job if it does not exist
ZITADEL_DATABASE_POSTGRES_USER_USERNAME=zitadel
ZITADEL_DATABASE_POSTGRES_USER_PASSWORD=__REPLACE_ME__
ZITADEL_DATABASE_POSTGRES_USER_SSL_MODE=disable

# First instance configuration
# By configuring a login client, the setup job creates a user of type machine with the role IAM_LOGIN_CLIENT.
ZITADEL_FIRSTINSTANCE_LOGINCLIENTPATPATH=/zitadel/login-client.pat
ZITADEL_FIRSTINSTANCE_ORG_HUMAN_PASSWORDCHANGEREQUIRED=false
ZITADEL_FIRSTINSTANCE_ORG_LOGINCLIENT_MACHINE_USERNAME=login-client
ZITADEL_FIRSTINSTANCE_ORG_LOGINCLIENT_MACHINE_NAME=Automatically Initialized IAM_LOGIN_CLIENT
ZITADEL_FIRSTINSTANCE_ORG_LOGINCLIENT_PAT_EXPIRATIONDATE=2029-01-01T00:00:00Z

# Login v2 configuration
ZITADEL_DEFAULTINSTANCE_FEATURES_LOGINV2_REQUIRED=true
ZITADEL_DEFAULTINSTANCE_FEATURES_LOGINV2_BASEURI=https://id.home.internal/ui/v2/login
ZITADEL_OIDC_DEFAULTLOGINURLV2=https://id.home.internal/ui/v2/login/login?authRequest=
ZITADEL_OIDC_DEFAULTLOGOUTURLV2=https://id.home.internal/ui/v2/login/logout?post_logout_redirect=
ZITADEL_SAML_DEFAULTLOGINURLV2=https://id.home.internal/ui/v2/login/login?samlRequest=

# Command (optional, default: start)
# Options:
#   - start: starts ZITADEL (use after init/setup)
#   - start-from-init: cold start (init + setup + start) - use for first run
#   - start-from-setup: start after init (setup + start)
# ZITADEL_COMMAND=start-from-init

# Optional: Machine user for Terraform/API access
# ZITADEL_FIRSTINSTANCE_PATPATH=/zitadel/admin.pat
# ZITADEL_FIRSTINSTANCE_ORG_MACHINE_MACHINE_USERNAME=admin
# ZITADEL_FIRSTINSTANCE_ORG_MACHINE_MACHINE_NAME=Automatically Initialized IAM_OWNER
# ZITADEL_FIRSTINSTANCE_ORG_MACHINE_PAT_EXPIRATIONDATE=2029-01-01T00:00:00Z

# Optional: Custom organization and admin user
# ZITADEL_FIRSTINSTANCE_ORG_NAME=My Organization
# ZITADEL_FIRSTINSTANCE_ORG_HUMAN_USERNAME=root
# ZITADEL_FIRSTINSTANCE_ORG_HUMAN_PASSWORD=RootPassword1!

# Optional: Debug logging
# ZITADEL_LOG_LEVEL=debug
# ZITADEL_LOGSTORE_ACCESS_STDOUT_ENABLED=true
